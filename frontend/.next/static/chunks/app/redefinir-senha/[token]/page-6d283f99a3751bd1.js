(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[35],{464:(e,o,a)=>{"use strict";a.r(o),a.d(o,{default:()=>d});var r=a(5155),n=a(2115),s=a(5695),t=a(6874),i=a.n(t);function d(){let[e,o]=(0,n.useState)(""),[a,t]=(0,n.useState)(""),[d,l]=(0,n.useState)(""),[u,c]=(0,n.useState)(""),[m,h]=(0,n.useState)(!1),[f,p]=(0,n.useState)(null),g=(0,s.useParams)(),x=(0,s.useRouter)();console.log("Token original da URL:",null==g?void 0:g.token),(0,n.useEffect)(()=>{if(null==g?void 0:g.token){let e=Array.isArray(g.token)?g.token[0]:g.token,o=decodeURIComponent(e);console.log("Token da URL:",e),console.log("Token decodificado:",o),p(o)}else c("Token de redefini\xe7\xe3o n\xe3o encontrado na URL."),console.error("Token n\xe3o encontrado nos par\xe2metros da URL:",g)},[g]);let b=async o=>{if(o.preventDefault(),h(!0),l(""),c(""),!f){c("Token de redefini\xe7\xe3o inv\xe1lido ou ausente."),h(!1);return}if(!e||!a){c("Por favor, preencha ambos os campos de senha."),h(!1);return}if(e!==a){c("As senhas n\xe3o coincidem."),h(!1);return}if(e.length<8){c("A nova senha deve ter pelo menos 8 caracteres."),h(!1);return}let r="http://localhost:8000/api";if(!r){console.error("Erro Cr\xedtico: A vari\xe1vel de ambiente NEXT_PUBLIC_API_URL n\xe3o est\xe1 definida!"),c("Erro de configura\xe7\xe3o do sistema. Contate o administrador."),h(!1);return}let n="".concat(r,"/auth/reset-password");console.log("Enviando requisi\xe7\xe3o de redefini\xe7\xe3o para: ".concat(n));try{let o={token:f,nova_senha:e,confirmacao_nova_senha:a};console.log("Corpo da requisi\xe7\xe3o para o backend:",JSON.stringify(o));let r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),s=await r.json();console.log("Resposta completa da API:",s),r.ok?(l(s.message||"Senha redefinida com sucesso! Voc\xea j\xe1 pode fazer login com sua nova senha."),setTimeout(()=>{x.push("/login")},3e3)):(console.error("Erro na resposta da API:",(null==s?void 0:s.detail)||r.statusText),c((null==s?void 0:s.detail)||"Ocorreu um erro ao redefinir sua senha. O link pode ter expirado ou ser inv\xe1lido."))}catch(e){console.error("Erro ao redefinir senha:",e),c("Ocorreu um erro ao processar sua solicita\xe7\xe3o. Tente novamente mais tarde.")}h(!1)};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Redefinir Senha"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Crie uma nova senha para sua conta."})]}),d&&(0,r.jsxs)("div",{className:"mb-4 p-3 rounded bg-green-100 text-green-800 text-sm",children:[d,(0,r.jsx)("p",{className:"mt-2",children:"Voc\xea ser\xe1 redirecionado para a p\xe1gina de login em breve..."})]}),u&&(0,r.jsx)("div",{className:"mb-4 p-3 rounded bg-red-100 text-red-800 text-sm",children:u}),f&&!d&&(0,r.jsxs)("form",{onSubmit:b,className:"space-y-5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nova Senha"}),(0,r.jsx)("input",{id:"password",name:"password",type:"password",value:e,onChange:e=>o(e.target.value),required:!0,minLength:8,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite sua nova senha",disabled:m})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar Nova Senha"}),(0,r.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:a,onChange:e=>t(e.target.value),required:!0,minLength:8,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirme sua nova senha",disabled:m})]}),(0,r.jsx)("button",{type:"submit",disabled:m||!f,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ".concat(m||!f?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"),children:m?"Redefinindo...":"Redefinir Senha"})]}),(u||!f)&&!d&&(0,r.jsx)("div",{className:"mt-6 text-center text-sm",children:(0,r.jsx)(i(),{href:"/login",className:"text-blue-600 hover:text-blue-500",children:"Voltar para o Login"})})]})})}},3498:(e,o,a)=>{Promise.resolve().then(a.bind(a,464))},5695:(e,o,a)=>{"use strict";var r=a(8999);a.o(r,"useParams")&&a.d(o,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(o,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(o,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(o,{useSearchParams:function(){return r.useSearchParams}})}},e=>{var o=o=>e(e.s=o);e.O(0,[874,441,684,358],()=>o(3498)),_N_E=e.O()}]);