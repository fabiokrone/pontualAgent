(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{2650:(e,a,t)=>{Promise.resolve().then(t.bind(t,3002))},3002:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l});var s=t(5155),r=t(2115),i=t(5695);function l(){let[e,a]=(0,r.useState)(null),[t,l]=(0,r.useState)(!1),[d,o]=(0,r.useState)([]),[n,c]=(0,r.useState)(""),[m,x]=(0,r.useState)(""),u=(0,i.useRouter)(),p=async t=>{if(t.preventDefault(),!e)return void c("Por favor, selecione um arquivo para importar");l(!0),c(""),x("");try{let t=new FormData;t.append("file",e);let s=await fetch("http://localhost:8000/api/batidas/importar",{method:"POST",body:t,headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),r=await s.json();if(!s.ok)throw Error(r.detail||"Erro ao importar batidas");x("Arquivo importado com sucesso! ".concat(r.total_batidas||0," batidas processadas.")),a(null),o([]),setTimeout(()=>{u.push("/dashboard/batidas")},2e3)}catch(e){c(e.message||"Ocorreu um erro ao importar o arquivo")}finally{l(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Importar Batidas"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Fa\xe7a upload de um arquivo de batidas para processamento"})]}),(0,s.jsx)("button",{onClick:()=>u.back(),className:"px-4 py-2 text-sm text-gray-600 bg-gray-100 rounded-md hover:bg-gray-200",children:"Voltar"})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,s.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[n&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:n}),m&&(0,s.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:m}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Arquivo de Batidas"}),(0,s.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,s.jsxs)("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,s.jsx)("svg",{className:"w-10 h-10 mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,s.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Clique para selecionar"})," ou arraste e solte"]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Arquivo de texto (.txt) com formato espec\xedfico"})]}),(0,s.jsx)("input",{type:"file",className:"hidden",accept:".txt,text/plain",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(!s)return;if("text/plain"!==s.type&&!s.name.endsWith(".txt")){c("Por favor, selecione um arquivo de texto (.txt)"),a(null);return}a(s),c("");let r=new FileReader;r.onload=e=>{var a;o((null==(a=e.target)?void 0:a.result).split("\n").filter(e=>""!==e.trim()).slice(0,10).map(e=>e.split("|")))},r.readAsText(s)},disabled:t})]})}),e&&(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Arquivo selecionado: ",(0,s.jsx)("span",{className:"font-medium",children:e.name})," (",(e.size/1024).toFixed(2)," KB)"]})]}),d.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"Preview do Arquivo"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Empresa"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Matr\xedcula"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Local"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hora"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sentido"}),(0,s.jsx)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Terminal"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map((e,a)=>(0,s.jsx)("tr",{children:e.map((e,a)=>(0,s.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:e},a))},a))})]})}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 italic",children:["Mostrando ",d.length," de ",(null==e?void 0:e.size)?Math.ceil(e.size/100):"?"," linhas estimadas"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-4",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,s.jsx)("p",{children:"Formato esperado: empresa|matricula|local|data|hora|tipo|sentido|terminal"}),(0,s.jsx)("p",{children:"Exemplo: 000001|00003347|000001|01082024|0740|1|1|000001"})]}),(0,s.jsx)("button",{type:"submit",disabled:!e||t,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:t?"Importando...":"Importar Batidas"})]})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:"Instru\xe7\xf5es"}),(0,s.jsxs)("div",{className:"space-y-3 text-sm text-gray-600",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"1."})," Prepare um arquivo de texto (.txt) com as batidas no formato especificado."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"2."})," Cada linha deve conter uma batida no formato: empresa|matricula|local|data|hora|tipo|sentido|terminal"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"3."})," A data deve estar no formato DDMMAAAA e a hora no formato HHMM."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"4."}),' Selecione o arquivo e clique em "Importar Batidas".']}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"5."})," Ap\xf3s a importa\xe7\xe3o, as batidas ser\xe3o processadas automaticamente."]})]})]})]})}},5695:(e,a,t)=>{"use strict";var s=t(8999);t.o(s,"useParams")&&t.d(a,{useParams:function(){return s.useParams}}),t.o(s,"usePathname")&&t.d(a,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(a,{useSearchParams:function(){return s.useSearchParams}})}},e=>{var a=a=>e(e.s=a);e.O(0,[441,684,358],()=>a(2650)),_N_E=e.O()}]);